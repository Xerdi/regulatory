%! Package = PACKAGE_NAME
%! Author = erik
%! Date = 28-01-2023

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{legalentity}[2023/01/28 Xerdi's Legal Entity's Package]

\RequirePackage{pgf}
\RequirePackage{suffix}
\RequirePackage{tabularx}

\newcommand\newentity[2]{
    \pgfkeys{
        /#1/.is family,
        /#1,
        name/.initial=<naam>,
        title/.initial=<functie titel>,
        gender/.initial=<male|female>,
        company/.initial=<bedrijf>,
        kvk/.initial=<kvk nummer>,
        website/.initial=<website>,
        email/.initial=<e-mail>,
        address/.initial=<adres>,
        postal/.initial=<postcode>,
        place/.initial=<plaats>,
        iban/.initial=<iban>,
        sign date/.initial=<datum>,
        sign place/.initial=<plaats>
    }
    \pgfkeys{/#1,#2}
}

\newcommand\nameFor[1]{\pgfkeysvalueof{/#1/name}}
\newcommand\titleFor[1]{\pgfkeysvalueof{/#1/title}}
\newcommand\companyFor[1]{\pgfkeysvalueof{/#1/company}}
\newcommand\kvkFor[1]{\pgfkeysvalueof{/#1/kvk}}
\newcommand\websiteFor[1]{\pgfkeysvalueof{/#1/website}}
\newcommand\emailFor[1]{\pgfkeysvalueof{/#1/email}}
\newcommand\addressFor[1]{\pgfkeysvalueof{/#1/address}}
\newcommand\postalFor[1]{\pgfkeysvalueof{/#1/postal}}
\newcommand\placeFor[1]{\pgfkeysvalueof{/#1/place}}
\newcommand\ibanFor[1]{\pgfkeysvalueof{/#1/iban}}
\newcommand\signdateFor[1]{\pgfkeysvalueof{/#1/sign date}}
\newcommand\signplaceFor[1]{\pgfkeysvalueof{/#1/sign place}}

\newcommand\salute[1]{%
    \ifthenelse{\equal{\pgfkeysvalueof{/#1/gender}}{female}}{mevrouw }{de heer }%
    \nameFor{#1}%
}
\WithSuffix\newcommand\salute*[1]{%
    \ifthenelse{\equal{\pgfkeysvalueof{/#1/gender}}{female}}{mevr.\ }{dhr.\ }%
    \nameFor{#1}%
}

\newcommand\Salute[1]{%
    \ifthenelse{\equal{\pgfkeysvalueof{/#1/gender}}{female}}{Mevrouw }{De heer }%
    \nameFor{#1}%
}

\WithSuffix\newcommand\Salute*[1]{%
    \ifthenelse{\equal{\pgfkeysvalueof{/#1/gender}}{female}}{Mevr.\ }{Dhr.\ }%
    \nameFor{#1}%
}

\newcommand\signature[1]{
    \noindent\textbf{\companyFor{#1}} \\
    \vspace{3cm}\\
    {\tiny Handtekening:}\\[-1em]
    \rule{\linewidth}{.1pt}
    \\[1em]
    \begin{tabular}{@{}p{.2\linewidth}@{}p{.8\linewidth}@{}}
        Naam:    & \nameFor{#1}      \\
        Functie: & \titleFor{#1}     \\
        Datum:   & \signdateFor{#1}  \\
        Plaats:  & \signplaceFor{#1} \\
    \end{tabular}
}

\newcommand\contact[1]{%
    \artikel{Contactgegevens \companyFor{#1}, \nameFor{#1}}\label{sec:contact}
    \begin{tabularx}{\linewidth}{@{}l l X l l@{}}
        Bedrijfsnaam:       & \companyFor{#1}               & & KvK-nummer: & \kvkFor{#1}     \\
        Adres:              & \addressFor{#1}               & & E-mail:     & \emailFor{#1}   \\
        Postcode en plaats: & \postalFor{#1}, \placeFor{#1} & & Website:    & \websiteFor{#1} \\
    \end{tabularx}
}
